<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>How to Expose Properties in a WPF UserControl</title>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            background-color: #ffffff;
            padding: 2em;
            line-height: 1.7;
            color: #1a1a1a;
            font-size: 16px;
        }

        h1, h2, h3 {
            color: #202020;
        }

        code {
            background-color: #f4f4f4;
            padding: 0.1em 0.4em;
            font-family: Consolas, monospace;
            border-radius: 4px;
            font-size: 0.95em;
        }

        pre {
            background-color: #f4f4f4;
            padding: 1em;
            border-radius: 5px;
            overflow-x: auto;
            font-family: Consolas, monospace;
            font-size: 0.95em;
        }

        ul {
            margin-left: 1.5em;
        }
    </style>
</head>
<body>

<h1>How to Expose Properties in a WPF UserControl (Step-by-Step)</h1>

<p>This guide will walk you through how to create a custom control in WPF that allows you to set the content of a button and a checkbox from outside the control — for example, in a window or another control that uses your custom control.</p>

<hr>

<h2>Step 1: Create the XAML File for Your Custom Control</h2>

<p>In Visual Studio, create a new <strong>UserControl</strong> called <code>TaskStepControl.xaml</code>. Then, open the file and replace its contents with the following:</p>

<pre><code>&lt;UserControl x:Class="TaskStepControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:EZLogger"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="800"&gt;

    &lt;Grid&gt;
        &lt;GroupBox Margin="5,5,0,0"
                  VerticalAlignment="Top"
                  FontFamily="Lucida Fax"
                  Height="80"
                  BorderBrush="Black"
                  Foreground="#FF464646"
                  HorizontalAlignment="Left"
                  Width="335"&gt;

            &lt;StackPanel Margin="-5,-14,-7,-6" Orientation="Horizontal"&gt;
                &lt;Button Content="{Binding ButtonContent, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        Height="35"
                        Width="45"
                        Margin="12,6,0,0"/&gt;

                &lt;CheckBox Content="{Binding CheckBoxContent, RelativeSource={RelativeSource AncestorType=UserControl}}"
                          Height="25"
                          Width="130"
                          Margin="6,12,0,0"/&gt;
            &lt;/StackPanel&gt;
        &lt;/GroupBox&gt;
    &lt;/Grid&gt;

&lt;/UserControl&gt;
</code></pre>

<p>This creates a basic layout with a button and a checkbox. The <code>Content</code> of both elements is bound to properties we’ll expose next.</p>

<hr>

<h2>Step 2: Create the Code-Behind File (xaml.vb)</h2>

<p>Now open the <code>TaskStepControl.xaml.vb</code> file and replace any existing code with this:</p>

<pre><code>Imports System.Windows
Imports System.Windows.Controls

Public Class TaskStepControl
    Inherits UserControl

    ' Constructor
    Public Sub New()
        InitializeComponent()
    End Sub

    ' Define ButtonContent as a dependency property
    Public Shared ReadOnly ButtonContentProperty As DependencyProperty =
        DependencyProperty.Register(
            "ButtonContent",
            GetType(String),
            GetType(TaskStepControl),
            New PropertyMetadata("Button"))

    Public Property ButtonContent As String
        Get
            Return CType(GetValue(ButtonContentProperty), String)
        End Get
        Set(value As String)
            SetValue(ButtonContentProperty, value)
        End Set
    End Property

    ' Define CheckBoxContent as a dependency property
    Public Shared ReadOnly CheckBoxContentProperty As DependencyProperty =
        DependencyProperty.Register(
            "CheckBoxContent",
            GetType(String),
            GetType(TaskStepControl),
            New PropertyMetadata("CheckBox"))

    Public Property CheckBoxContent As String
        Get
            Return CType(GetValue(CheckBoxContentProperty), String)
        End Get
        Set(value As String)
            SetValue(CheckBoxContentProperty, value)
        End Set
    End Property
End Class
</code></pre>

<p>These are dependency properties. They let the control expose values that can be set from XAML or changed dynamically in code.</p>

<hr>

<h2>Step 3: Use the Control in a Window or Another Control</h2>

<p>Now go to the XAML of your main window — for example, <code>MainWindow.xaml</code> — and do the following:</p>

<h3>Step 3.1: Add the Namespace</h3>
<p>At the top of your XAML file, add this to the <code>&lt;Window&gt;</code> element:</p>

<pre><code>xmlns:local="clr-namespace:EZLogger"</code></pre>

<p>This lets you access the <code>TaskStepControl</code> from within the window.</p>

<h3>Step 3.2: Use the Control</h3>
<p>Inside the window’s layout, add the control like this:</p>

<pre><code>&lt;local:TaskStepControl
    ButtonContent="Run"
    CheckBoxContent="Enable Logging"
    Margin="20" /&gt;
</code></pre>

<p>This renders your custom control with a button that says "Run" and a checkbox that says "Enable Logging".</p>

<hr>

<h2>Step 4: (Optional) Set the Properties in Code</h2>

<p>If you gave your control a name in the window’s XAML:</p>

<pre><code>&lt;local:TaskStepControl x:Name="MyTaskStepControl"
                        ButtonContent="Save"
                        CheckBoxContent="Confirm" /&gt;
</code></pre>

<p>You can set or change the property values in your code-behind file like this:</p>

<pre><code>MyTaskStepControl.ButtonContent = "Start"
MyTaskStepControl.CheckBoxContent = "Agree to Terms"
</code></pre>

<hr>

<h2>Success!</h2>
<p>You’ve now created a reusable control with exposed properties. This same technique works for other controls too — like setting text, colors, visibility, and more.</p>

<h3>Keep in Mind:</h3>
<ul>
    <li>Use dependency properties for any values you want to make public from a UserControl.</li>
    <li>Always bind using <code>RelativeSource AncestorType=UserControl</code> when referencing properties on the same control.</li>
    <li>Call <code>InitializeComponent()</code> in the constructor or your XAML won't show up at runtime.</li>
</ul>

</body>
</html>
